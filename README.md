# TSS Calculator
#### Video Demo:  <[Video Link](https://youtu.be/dLQ3QY96JVg)>
#### Description:

Zwift is a massively multiplayer online cycling and running physical training program that enables users to interact, train, and compete in a virtual world.

This project is a simplified version of a TSS (training stress score) calculator that I want to use as a team captain (Director Sportive) for Team Time Trial races in Zwift. The purpose of it is to optimize to an extent the distribution of workload (TSS) between the 8 riders (ideally), so that we can finish with as many riders as possible (4 at minimum). If TSS is distributed well among all the riders, we can have ideally all 8 riders until the final kilometers of the race, which means more drafting for everyone, which means everyone can be more "rested" throughout the race so we can achieve as fast time as possible by saving more energy for the finish. It is also good, that we all have a feeling we contributed somewhat equally towards the team's result, which can be in a way measured with the rider's final TSS score.

The program takes in a .csv file from the Google Sheets where we specify the team composition, rider's power at the front (W), their FTP and other metrics that aren't used in this program. It also takes the user's estimation of the team's estimated time to complete the course and maximum desired TSS difference between the 8 team members. For the purpose of this program, we only need the rider names, their FTP and their suggested Lead Power. The rest is calculated by the program. Also, to simply for the purposes of this program and calculation times, we only use 30s for each rider for times on the front of the group. We normally use also other times (45, 60, 90 and 120 seconds), but for demonstration I used only 30s so that the program runs faster, with each additional time option, the number of combinations increases greatly, from 40.320 (8! for all possible rider orders) * 30s for each, to much greater numbers if each rider can have either 30s or 60s or even more options.

The program then calculates metrics like full cycle time (8x 30s in this case), cycles per course (240s / input in minutes *60), rider's position, power (in Watts) at each of 8 positions, time spent at each of 8 positions (in seconds), NP (normalized power) and TSS for each rider and finally, TSS difference for each iteration of 8 riders. It then checks what the input for maximum desired TSS difference was and only writes the results of the iterations, where the desired amount was lower in a .csv file. This enables me as a captain, to get the best order of riders where we do the most equal amount of work which makes the work distrubution as fair as possible and possibly help us achieve the fastest time we could have (theoretically of course).

I had some dilemmas on the design as I encountered issues with the calculation times when I increase the number of possible time combinations for each iteration of 40.320 rider orders. In the end I decided to go for only 30s for each rider for the purposes of this first version for this project. I could further optimize this by removing 7/8 rider orders from 40.320 to 5.040 as the riders are changing positions cyclicaly so only 1 out of every 8 cyclcal options is needed. This would optimize the performance for sure. For times, to have a way of optimizing it, I could also assign everyone 30s at the start, and then for each iteration of 5.040 orders, take the one with the lowest TSS difference, take the rider with the smallest TSS and increase their time to the next item in the list of [30, 45, 60, 90, 120] which would increase this rider's TSS and decrease the team's TSS difference. I could keep cycling like this until I get the option, where I would get the minimal TSS difference based on this way of rider order & time optimization.
